#include "stdafx.hpp"

#include "snake_overflow/invulnerability_spell.hpp"
#include "snake_overflow/snake.hpp"

namespace snake_overflow
{

invulnerability_spell::invulnerability_spell(int const duration)
    : duration{duration}
{
}

void invulnerability_spell::affect(snake& s)
{
    --(this->duration);

    s.invulnerability_bonus = (this->duration > 0);

    if (this->duration == 0)
    {
        stop_affecting_snake_and_cause_self_destruction(s);
    }
}

int invulnerability_spell::get_duration() const
{
    return this->duration;
}

void invulnerability_spell::stop_affecting_snake_and_cause_self_destruction(
    snake& s) const
{
    s.remove_spell(*this);
}

}